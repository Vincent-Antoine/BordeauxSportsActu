<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <title>{% block title %}Bordeaux Sports Actu{% endblock %}</title>

        <!-- Favicon -->
        <link rel="icon" type="image/png" href="{{ asset('medias/bsa-fav-icon-dark.png') }}">
        <link rel="shortcut icon" href="{{ asset('medias/bsa-fav-icon-dark.png') }}">

        <!-- Préconnexion CDN (optimisation) -->
        <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>

        <!-- Feuilles de styles -->
        {% block stylesheets %}
            {{ encore_entry_link_tags('app') }}
        {% endblock %}
        <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"></noscript>
        <!-- Librairies JS -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/flowbite/1.6.5/flowbite.min.js" defer></script>

        <!-- Optimisation Google Fonts -->
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Anton&family=Courgette&family=Roboto+Condensed:ital,wght@0,100..900;1,100..900&display=swap" onload="this.onload=null;this.rel='stylesheet'">
        <noscript>
            <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Anton&family=Courgette&family=Roboto+Condensed:ital,wght@0,100..900;1,100..900&display=swap">
        </noscript>

        <!-- Métadonnées SEO -->
        <meta name="description" content="{% block meta_description %}Actus sportives à Bordeaux.{% endblock %}">
        <meta name="author" content="Bordeaux Sports Actu">
        <meta name="robots" content="index, follow">

                <!-- Google Tag Manager -->
        


    </head>

    <body class="bg-[#dce6ef]">
        
        {% include 'header.html.twig' %}

        <main role="main" class="sm:max-w-xl md:max-w-full lg:max-w-screen-xl md:px-24 lg:px-8 mx-auto px-4 mt-8">
            {% block body %}{% endblock %}
        </main>

        {% include 'footer.html.twig' %}

        {% block javascripts %}
    {{ encore_entry_script_tags('app') }}

    <!-- Initialisation Axeptio -->
    <script>
        console.log("[Axeptio] Initialisation du widget...");
        window.axeptioSettings = {
            clientId: "6800b1c97e1ab3015a54ec5f",
            cookiesVersion: "bordeauxsportsactu-fr-EU"
        };
        (function(d, s) {
            var t = d.getElementsByTagName(s)[0], e = d.createElement(s);
            e.async = true; e.src = "https://static.axept.io/sdk.js";
            t.parentNode.insertBefore(e, t);
        })(document, "script");
    </script>

    <!-- Consentement Axeptio -->
<script>
    console.log("[Axeptio] Initialisation du widget…");

    window.axeptioSettings = {
        clientId: "6800b1c97e1ab3015a54ec5f",
        cookiesVersion: "bordeauxsportsactu-fr-EU"
    };

    // Charger le SDK Axeptio (une seule fois)
    (function(d, s) {
        if (d.getElementById("axeptio-sdk")) return;
        var t = d.getElementsByTagName(s)[0], e = d.createElement(s);
        e.id = "axeptio-sdk";
        e.async = true;
        e.src = "https://static.axept.io/sdk.js";
        t.parentNode.insertBefore(e, t);
    })(document, "script");

    // Code exécuté après chargement du widget Axeptio
    window._axcb = window._axcb || [];
    window._axcb.push(function(axeptio) {
        console.log("[Axeptio] Widget chargé ✔️");

        axeptio.on("cookies:complete", function (preferences) {
            console.log("[Axeptio] Consentement donné ✅", preferences);

            for (const key in preferences) {
                console.log(`Préférence : ${key} =>`, preferences[key]);
            }

            // Chargement Microsoft Clarity
            if (preferences.clarity) {
                console.log("[Consentement] Clarity accepté ✅ — chargement du script");
                (function(c,l,a,r,i,t,y){
                    c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
                    t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/r55tp5wwbi";
                    y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
                })(window, document, "clarity", "script");
            } else {
                console.warn("[Consentement] Clarity refusé ❌ — script non chargé");
            }

            // Chargement Google Tag Manager
            if (preferences.google_tag_manager) {
                console.log("[Consentement] GTM accepté ✅ — chargement du script");
                (function(w,d,s,l,i){
                    w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});
                    var f=d.getElementsByTagName(s)[0],
                    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';
                    j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;
                    f.parentNode.insertBefore(j,f);
                })(window,document,'script','dataLayer','GTM-T4CG3Z4N');
            } else {
                console.warn("[Consentement] GTM refusé ❌ — script non chargé");
            }
        });
    });
</script>



{% endblock %}


    </body>
</html>
